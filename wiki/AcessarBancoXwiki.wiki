#summary A dsl.jar deve acessar o banco da xwiki

= Introduction =

Para a dsl.jar acessar (ler e escrever) no banco da xwiki tenho duas opções: <br>
1- Acessando o banco diretamente; <br>
2- Através de uma api da xwiki.

O passo 2 me exigiria um estudo desta api e provavelmente que eu transformasse minha dsl.jar em uma api da xwiki. Então optei pelo passo 1 que parece ser mais rápido. Assim, devo:

1- Encontrar onde a xwiki armazena seus conteúdos criadas na página xwiki; <br>
2- Ler e escrever na tabela; <br>
3- Criar um programa com jdbc que acesse um banco qualquer; <br>
4- Fazer esse programa com jdbc acessar a tabela do banco da xwiki onde armazena os dados que desejo manipular; <br>
5- Inserir esse programa na minha dsl.jar; <br>
6- Deixar minha xwiki o mais simples possível.

== 1.Encontrar onde a xwiki armazena seus conteúdos criadas na página xwiki ==
Comecei procurando o conteúdo com comandos em sql, mas tava muito difícil de encontrar, daí instalei o PgAdmin III (tinha tentando o PhpPostgreAdmin, mas precisava do apache então descartei essa opção).

O William deu a dica de procurar pela estrutura da tabela, aquela que tiver o maior campo.

Consegui encontrar onde a xwiki armazena minhas páginas criadas. É na tabela *xwikidoc*.

== 2 Ler e escrever na tabela ==
Isso consegui facilmente usando o programa PgAdmin III

== 3 Criar um programa com jdbc que acesse o banco da Xwiki ==

*3.1* Criar uma classe que acesse meu banco: <br>
http://www.mkyong.com/java/how-do-connect-to-postgresql-with-jdbc-driver-java/ <br>
No terminal tenho que configurar o path: <br>
export CLASSPATH=$CLASSPATH:/home/david/JavaJDBC/postgresql-9.0-801.jdbc4.jar <br>
AcessoBanco.java lê (SELECT) e escreve (UPDATE) diretamente no banco exibindo no terminal. 

*3.2* Criar uma classe que leia do banco e escreva num txt: 

*3.3* Fazer a classe AcessoBancoEscritaTxt se comunicar com a minha dsl.jar: 

*3.4* AcessoBancoEscritaTxt deve virar: SelectBancoEscritaTxtUpdateBanco: 

Ou seja, preciso que a classe que se comunique com meu banco faça: <br>
# Leia do banco (Modelo) -> Atividade da ClasseAuxiliar <br>
# Gere um txt com o Modelo lido -> Atividade da ClasseAuxiliar <br>
# Esse Modelo servirá de entrada para minha dsl.jar (TEST.java) que irá transformar em códigofonte.cpp -> Atividade da Classe Test <br>
# CódigoFonte.cpp deve ser inserido em uma tabela -> Atividade ClasseAuxiliar <br>

Vamos chamar a classe Auxilar que irá ler do banco, gerar um txt e depois escrever no banco. E a classe Test é aquela que se comunica com a minha gramática MyDsl.g